<!doctype html>
<html lang="en">
<head>
  <link rel="stylesheet" href="../assets/brand.css">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lesson 16 ‚Ä¢ First semester exam</title>
  <!-- Font Nunito: Rounded and Friendly -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@500;700;800;900&display=swap" rel="stylesheet">
  <style>
    /* --- VIBRANT THEME FOR KIDS (3-6YO) --- */
    :root{
      --bg-color: #fff9e6; /* Creamy yellow */
      --card-bg: #ffffff;
      --text: #4a4a4a;
      
      /* Kid Palette */
      --c-blue: #4CC9F0;
      --c-pink: #F72585;
      --c-yellow: #FFD166;
      --c-green: #06D6A0;
      --c-purple: #7209B7;
      --c-orange: #fb8500;
      
      --shadow-color: rgba(0,0,0,0.15);
      --radius: 24px;
    }

    * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
    html, body { margin: 0; padding: 0; width: 100%; height: 100%; }
    
    body{
      font-family: "Nunito", sans-serif;
      color: var(--text);
      min-height: 100vh;
      /* Playful background pattern */
      background-color: var(--bg-color);
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(247, 37, 133, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(76, 201, 240, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 50% 50%, rgba(255, 209, 102, 0.15) 0%, transparent 30%);
      overflow-x: hidden;
    }

    /* Floating Header Logo */
    .oodles-logo-container {
        position: fixed; top: 12px; left: 16px; z-index: 10;
        background: #fff; padding: 8px 16px; border-radius: 99px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        display: flex; align-items: center; gap: 8px;
        border: 2px solid var(--c-blue);
    }
    .oodles-logo-icon { font-size: 24px; animation: bounce 2s infinite; }
    .oodles-logo-text { font-size: 20px; font-weight: 900; color: var(--c-blue); letter-spacing: 1px; }
    
    @keyframes bounce { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-5px);} }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 80px 20px 20px; /* Top padding for logo */
      display:grid;
      grid-template-columns: 380px 1fr;
      gap: 24px;
      min-height: 100vh;
    }

    /* --- CARDS & PANELS --- */
    .card{
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: 0 10px 25px var(--shadow-color);
      border: 3px solid #fff;
      overflow: hidden;
      position: relative;
      display: flex; flex-direction: column;
      z-index: 1;
    }

    /* Header styling */
    header{
      padding: 16px 20px;
      background: #fdfdfd;
      border-bottom: 2px dashed #eee;
      display: flex; align-items: center; justify-content: space-between; gap: 10px;
    }
    .brand { display: flex; align-items: center; gap: 12px; }
    .logo {
      width: 48px; height: 48px; border-radius: 16px;
      background: #e0f7fa; color: var(--c-blue);
      display: grid; place-items: center; font-size: 24px;
      border: 2px solid var(--c-blue);
    }
    .t b { display: block; font-size: 16px; color: var(--c-purple); }
    .t span { display: block; font-size: 13px; color: #888; font-weight: 700; }

    /* Chips (Score pills) */
    .chips { display: flex; gap: 8px; }
    .chip {
      background: var(--c-yellow); color: #7a5c00;
      border: 2px solid #f0b429;
      border-radius: 99px; padding: 6px 12px;
      font-size: 14px; font-weight: 800;
      box-shadow: 0 2px 0 rgba(0,0,0,0.1);
      display: flex; align-items: center; gap: 6px;
    }

    /* --- LEFT PANEL --- */
    .left .body { padding: 20px; background: linear-gradient(to bottom, #fff, #f9f9f9); flex: 1; }
    .big { font-size: 20px; color: var(--c-pink); margin-bottom: 8px; font-weight: 900; }
    .sub { font-size: 14px; color: #666; font-weight: 600; line-height: 1.5; }

    /* Buttons - 3D Style */
    .btnrow { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 16px; }
    .btn {
      border: none; border-radius: 16px;
      padding: 12px 20px; font-size: 16px; font-weight: 800;
      cursor: pointer; transition: transform 0.1s;
      display: inline-flex; align-items: center; gap: 8px;
      position: relative;
    }
    .btn:active { transform: translateY(4px); box-shadow: none !important; }
    
    .btn.primary {
      background: var(--c-blue); color: white;
      box-shadow: 0 6px 0 #2a9ec2;
    }
    .btn.danger {
      background: var(--c-pink); color: white;
      box-shadow: 0 6px 0 #d90429;
    }
    .btn.ghost {
      background: #f1f5f9; color: #64748b;
      box-shadow: 0 6px 0 #cbd5e1;
    }
    .btn.flag-btn {
      color: #b45309; border: 2px solid #f59e0b; background: #fffbeb;
      box-shadow: 0 4px 0 #f59e0b;
    }

    /* Progress Bar */
    .progress {
      margin-top: 20px; background: #fff;
      border: 2px solid #eee; border-radius: 20px; padding: 16px;
    }
    .meter {
      height: 16px; background: #eee; border-radius: 99px; overflow: hidden;
      border: 2px solid #e2e8f0;
    }
    .bar {
      height: 100%; width: 0%;
      background: repeating-linear-gradient(
        45deg,
        var(--c-green),
        var(--c-green) 10px,
        #4ade80 10px,
        #4ade80 20px
      );
      transition: width 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .row { display: flex; align-items: center; justify-content: space-between; gap: 12px; margin-bottom: 8px; }
    .small { font-size: 13px; color: #64748b; font-weight: 700; }

    /* Skill Breakdown Box */
    .skillbox { margin-top: 12px; display: grid; gap: 8px; }
    .skill {
      border: 2px solid #e2e8f0; border-radius: 12px;
      padding: 8px 12px; background: #fff;
      display: flex; align-items: center; justify-content: space-between; gap: 10px;
    }
    .skill b { font-size: 14px; color: #334155; }
    .skill span { font-size: 12px; font-weight: 700; color: #94a3b8; }
    .pill {
      font-size: 12px; padding: 4px 10px; border-radius: 99px; font-weight: 800;
    }
    .pill.ok { background: #dcfce7; color: #166534; }
    .pill.bad { background: #fee2e2; color: #991b1b; }
    .pill.mid { background: #fef3c7; color: #92400e; }

    /* --- RIGHT PANEL --- */
    .right .stage { padding: 20px; background: #ecfeff; flex: 1; display: flex; flex-direction: column;}
    .panel {
      background: #fff; border-radius: 24px; border: 4px solid var(--c-blue);
      padding: 20px; flex: 1; position: relative;
      box-shadow: 0 12px 0 rgba(76, 201, 240, 0.3);
      overflow-y: auto; display: flex; flex-direction: column;
    }

    .qtop { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .qtitle { font-size: 18px; color: var(--c-blue); font-weight: 800; }
    .tag {
      background: var(--c-yellow); color: #854d0e;
      padding: 6px 12px; border-radius: 20px; font-weight: 800; font-size: 13px;
    }

    /* Question Box */
    .question {
      background: #fff; border: 3px dashed #cbd5e1; border-radius: 20px;
      padding: 20px; margin-bottom: 20px;
    }
    .prompt { font-size: 24px; color: #1e293b; margin: 0; line-height: 1.3; font-weight: 800; }
    .hint { margin-top: 10px; color: #64748b; font-style: italic; font-weight: 600; display: block; }
    
    .speak-btn {
      width: 44px; height: 44px; background: var(--c-blue); color: white;
      border-radius: 50%; display: grid; place-items: center; font-size: 20px;
      cursor: pointer; box-shadow: 0 4px 0 #2a9ec2; transition: 0.2s;
      flex-shrink: 0; display: inline-grid; vertical-align: middle; margin-left: 8px;
    }
    .speak-btn:active { transform: translateY(4px); box-shadow: none; }

    /* Choices */
    .choices { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: auto; }
    .choice {
      background: #fff; border: 3px solid #e2e8f0; border-radius: 20px;
      padding: 16px; font-size: 24px; color: #334155; font-weight: 900;
      min-height: 80px; display: flex; align-items: center; justify-content: center;
      cursor: pointer; box-shadow: 0 6px 0 #cbd5e1; transition: 0.1s;
    }
    .choice:hover:not(:disabled) { transform: translateY(-4px); border-color: var(--c-blue); }
    .choice:active:not(:disabled) { transform: translateY(4px); box-shadow: 0 0 0; }
    
    .choice.selected {
      border-color: var(--c-blue); background: #e0f2fe; color: var(--c-blue);
      box-shadow: 0 6px 0 #0284c7;
    }
    .choice:disabled { opacity: 1; cursor: default; transform: none !important; box-shadow: none !important; border-width: 2px; }
    .choice.correct { background: #dcfce7; border-color: var(--c-green); color: var(--c-green); }
    .choice.wrong { background: #fee2e2; border-color: var(--c-pink); color: var(--c-pink); opacity: 0.7; }

    /* Navigation Bar */
    .nav { margin-top: 20px; display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    
    /* Grid Navigation (1-12 Dots) */
    .gridNav {
      margin-top: 20px; display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px;
      padding: 12px; background: #f8fafc; border-radius: 16px; border: 2px solid #e2e8f0;
    }
    .nav-item {
      border: 2px solid #e2e8f0; background: #fff; border-radius: 12px;
      padding: 8px 0; font-weight: 800; cursor: pointer; font-size: 14px;
      color: #64748b; transition: .2s;
    }
    .nav-item:hover { border-color: var(--c-blue); color: var(--c-blue); }
    .nav-item.cur { border-color: var(--c-blue); background: #e0f2fe; color: var(--c-blue); transform: scale(1.1); }
    .nav-item.answered { background: var(--c-green); border-color: var(--c-green); color: white; }
    .nav-item.flag { border-color: var(--c-orange); background: #fff7ed; color: var(--c-orange); }

    /* Visual Components (Count, Clock, Graph) */
    .count-grid {
      background: #fffbeb; border: 3px solid #fcd34d; border-radius: 20px;
      padding: 15px; gap: 8px; margin-top: 10px;
      display: flex; flex-wrap: wrap; justify-content: center;
    }
    .count-item { font-size: 36px; animation: popIn 0.4s backwards; }

    .two-cols{ display:grid; grid-template-columns: 1fr 1fr; gap: 12px; align-items:center; }

    .clock {
      width: 220px; height: 220px; border: 12px solid var(--c-blue);
      background: #fff; box-shadow: 0 10px 0 rgba(76, 201, 240, 0.3);
      border-radius: 50%; position: relative; margin: 0 auto;
    }
    .clock .center {
      width:16px; height:16px; border-radius:50%; background:#334155;
      position:absolute; left:50%; top:50%; transform: translate(-50%,-50%); z-index: 10;
    }
    .hand { position:absolute; left:50%; top:50%; transform-origin: bottom center; border-radius: 99px; z-index: 4; }
    .hand.hour { background: var(--c-pink); width: 10px; height: 60px; }
    .hand.minute { background: var(--c-blue); width: 6px; height: 85px; }
    .tick { position:absolute; left:50%; top:50%; width:4px; height:10px; background: #cbd5e1; border-radius: 2px; }
    .num { font-size: 20px; color: #334155; font-weight: 900; position:absolute; left:50%; top:50%; transform: translate(-50%,-50%); }

    /* Ten Frame Fix */
    .tenframe {
      border: 4px solid #94a3b8; background: #e2e8f0; gap: 8px; padding: 10px; margin: 0 auto;
      display: grid; grid-template-columns: repeat(5, 1fr); border-radius: 12px;
      /* Ensure it doesn't collapse */
      min-height: 100px; 
    }
    .cell { 
      background: #fff; border: none; border-radius: 8px; 
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); aspect-ratio: 1/1; 
      display: grid; place-items: center;
    }
    /* Renamed .dot to .t-dot to avoid conflicts */
    .t-dot { width: 24px; height: 24px; border-radius: 50%; background: var(--c-green); box-shadow: inset -2px -4px rgba(0,0,0,0.2); }
    .t-dot.blue { background: var(--c-blue); }

    /* Graph (Single Line Fix) */
    .graph { width: 100%; padding: 10px; border-radius: 16px; background: #fff; border: 2px solid #e2e8f0; }
    .gline { display: flex; align-items: center; gap: 12px; padding: 8px; border-bottom: 1px solid #f1f5f9; }
    .gline:last-child { border-bottom: none; }
    .gleft { flex-shrink: 0; font-weight:bold; min-width:80px; }
    .icons { 
        display: flex; gap: 4px; flex-wrap: nowrap; overflow-x: auto; 
        flex: 1; justify-content: flex-start; padding-bottom: 4px;
        scrollbar-width: thin; scrollbar-color: #cbd5e1 transparent;
    }
    .miniIcon {
      width: 24px; height: 24px; border-radius: 6px;
      background: #e0f2fe; color: var(--c-blue);
      display: grid; place-items: center; font-size: 14px; flex-shrink: 0;
    }

    /* Review Box */
    .reviewBox {
      width: 100%; text-align: left;
      border: 3px solid var(--c-purple); background: #f8fafc;
      border-radius: 16px; padding: 12px; margin-top: 16px;
      max-height: 400px; overflow-y: auto;
    }
    .reviewItem {
      padding: 12px; border-radius: 12px; background: #fff;
      border: 2px solid #f1f5f9; margin-bottom: 10px;
    }
    .reviewItem b { display: block; font-size: 14px; margin-bottom: 4px; color: var(--c-blue); }
    .reviewItem .m { color: #475569; font-size: 16px; margin-bottom: 6px; font-weight: 700; }
    .reviewItem .a { font-size: 14px; font-weight: 600; }
    .okTxt { color: var(--c-green); }
    .badTxt { color: var(--c-pink); }

    /* End Screen */
    .end {
      display: grid; place-items: center; text-align: center; height: 100%;
      padding: 20px; position: relative; z-index: 5;
    }
    #fireworks { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }

    @keyframes popIn { from{transform:scale(0.8); opacity:0;} to{transform:scale(1); opacity:1;} }

    @media (max-width: 900px){
      .wrap{ grid-template-columns: 1fr; padding-top: 70px;}
      .choices { grid-template-columns: 1fr; }
      .left { min-height: auto; }
      .two-cols { grid-template-columns: 1fr; }
      .clock{ width: 180px; height: 180px; }
    }
  </style>
</head>

<body>
  <img src="../assets/logo-oodles-math.png" class="oodles-logo">
  <div class="oodles-logo-container">
    <div class="oodles-logo-icon">üç≠</div>
    <div class="oodles-logo-text">OODLES MATH</div>
  </div>
  
  <div class="wrap">
    <!-- LEFT SIDEBAR -->
    <section class="card left">
      <header>
        <div class="brand">
          <div class="logo">üìù</div>
          <div class="t">
            <b>Exam Mode</b>
            <span>Semester 1</span>
          </div>
        </div>
        <div class="chips">
          <div class="chip" id="chipTimer">‚è± 08:00</div>
          <div class="chip" id="chipStatus">üß© 0/12</div>
        </div>
      </header>

      <div class="body">
        <div class="big">Semester 1 Exam</div>
        <div class="sub">
          12 Questions ‚Ä¢ 8 Minutes.<br>
          Select one answer. Auto-submit when time is up. Good luck!
        </div>

        <div class="btnrow">
          <button class="btn primary" id="startBtn">‚ñ∂ Start</button>
          <button class="btn ghost" id="resetBtn">üîÑ Reset</button>
        </div>

        <div class="progress">
          <div class="row">
            <div class="small"><b>Progress</b></div>
            <div class="small" id="mini">Not started</div>
          </div>
          <div class="meter"><div class="bar" id="bar"></div></div>
        </div>

        <div class="progress" style="margin-top:12px">
          <div class="row" style="margin-bottom:6px">
            <div class="small"><b>Skill Breakdown</b></div>
            <div class="small" id="breakHint">Shown after exam</div>
          </div>
          <div class="skillbox" id="skillBox"></div>
        </div>
      </div>
    </section>

    <!-- MAIN GAME AREA -->
    <section class="card right">
      <header>
        <div class="brand">
          <div class="logo">üéØ</div>
          <div class="t">
            <b>Questions</b>
            <span>Choose & Click Next</span>
          </div>
        </div>
        <div class="chips">
          <div class="chip" id="chipScore">‚≠ê ‚Äî</div>
          <div class="chip" id="chipLevel">üè∑ ‚Äî</div>
        </div>
      </header>

      <div class="stage">
        <div class="panel">

          <!-- Welcome Screen -->
          <div class="end" id="welcome">
            <div style="text-align:center;">
              <div style="font-size:80px; margin-bottom:10px; filter: drop-shadow(0 8px 0 rgba(0,0,0,0.1));">üß†</div>
              <h2 style="font-size: 32px; color: var(--c-purple); margin: 10px 0;">First Semester Exam</h2>
              <p style="font-size: 18px; color: #666;">Press <b>Start</b> to begin. You have <b>08:00</b> minutes.</p>
            </div>
          </div>

          <!-- Quiz Screen -->
          <div id="quiz" style="display:none;">
            <div class="qtop">
              <div class="qtitle" id="qTitle">Question 1</div>
              <div class="tag" id="qTag">Counting</div>
            </div>

            <div class="question" id="qBox"></div>
            <div class="choices" id="choices"></div>

            <!-- Navigation Buttons -->
            <div class="nav">
              <button class="btn flag-btn" id="flagBtn">üö© Flag</button>
              <div style="display:flex; gap:10px;">
                <button class="btn ghost" id="prevBtn">‚Üê Prev</button>
                <button class="btn primary" id="nextBtn">Next ‚Üí</button>
              </div>
            </div>

            <!-- Question Grid (1-12) -->
            <div class="gridNav" id="gridNav"></div>

            <div class="nav" style="margin-top:10px; justify-content: flex-end;">
              <button class="btn danger" id="submitBtn">‚úÖ Submit Test</button>
            </div>
          </div>

          <!-- Finish Screen -->
          <div class="end" id="finish" style="display:none;">
            <canvas id="fireworks"></canvas>
            <div style="position:relative; z-index:2; background:rgba(255,255,255,0.9); padding:20px; border-radius:20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); width:100%; max-width:500px;">
              <div style="font-size:60px; margin-bottom: 10px; animation: bounce 2s infinite;">üèÜ</div>
              <h2 id="finalTitle" style="font-size:32px; color: var(--c-blue);">Test Submitted!</h2>
              <p id="finalText" style="font-size:18px;">...</p>
              
              <div class="btnrow" style="justify-content:center;">
                <button class="btn primary" id="reviewBtn">üëÄ Review Answers</button>
                <button class="btn ghost" id="newBtn">‚ñ∂ New Attempt</button>
              </div>

              <div class="reviewBox" id="reviewBox" style="display:none;"></div>
            </div>
          </div>

        </div>
      </div>
    </section>
  </div>

<script>
  // --- Audio System ---
  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  
  function playTone(freq, type, duration, vol=0.1) {
    if(audioCtx.state === 'suspended') audioCtx.resume();
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = type;
    osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
    gain.gain.setValueAtTime(vol, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + duration);
  }

  function sfxClick() { playTone(400, 'sine', 0.1, 0.05); } 
  function sfxSelect() { playTone(600, 'triangle', 0.1, 0.05); } 
  function sfxNav() { playTone(300, 'sine', 0.1, 0.03); } 
  function sfxSubmit() { 
    playTone(523.25, 'sine', 0.1, 0.1); 
    setTimeout(()=> playTone(659.25, 'sine', 0.1, 0.1), 100);
    setTimeout(()=> playTone(783.99, 'sine', 0.4, 0.1), 200);
    setTimeout(()=> playTone(1046.50, 'sine', 0.6, 0.1), 300);
  }

  // --- Fireworks System ---
  let fwLoop = null;
  const fwCanvas = document.getElementById("fireworks");
  const fwCtx = fwCanvas.getContext("2d");
  let particles = [];

  function resizeCanvas() {
    if(fwCanvas.parentElement){
        fwCanvas.width = fwCanvas.parentElement.offsetWidth;
        fwCanvas.height = fwCanvas.parentElement.offsetHeight;
    }
  }

  function createFirework(x, y) {
    const count = 40; 
    const color = `hsl(${Math.random()*360}, 100%, 50%)`;
    for (let i = 0; i < count; i++) {
      const angle = (Math.PI * 2 * i) / count;
      const speed = Math.random() * 4 + 2; 
      particles.push({
        x: x, y: y,
        vx: Math.cos(angle) * speed,
        vy: Math.sin(angle) * speed,
        alpha: 1,
        color: color,
        decay: Math.random() * 0.015 + 0.015
      });
    }
  }

  function updateFireworks() {
    fwCtx.globalCompositeOperation = 'destination-out';
    fwCtx.fillStyle = 'rgba(0, 0, 0, 0.1)'; 
    fwCtx.fillRect(0, 0, fwCanvas.width, fwCanvas.height);
    
    fwCtx.globalCompositeOperation = 'source-over';

    if(Math.random() < 0.08) { 
      createFirework(Math.random() * fwCanvas.width, Math.random() * fwCanvas.height * 0.6);
    }

    for (let i = particles.length - 1; i >= 0; i--) {
      let p = particles[i];
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.08; 
      p.alpha -= p.decay;

      fwCtx.globalAlpha = p.alpha;
      fwCtx.fillStyle = p.color;
      fwCtx.beginPath();
      fwCtx.arc(p.x, p.y, 3, 0, Math.PI * 2);
      fwCtx.fill();

      if (p.alpha <= 0) particles.splice(i, 1);
    }
    fwCtx.globalAlpha = 1;
    fwLoop = requestAnimationFrame(updateFireworks);
  }

  function startFireworks() {
    setTimeout(() => {
        resizeCanvas();
        particles = [];
        createFirework(fwCanvas.width/2, fwCanvas.height/2);
        if(fwLoop) cancelAnimationFrame(fwLoop);
        updateFireworks();
    }, 100);
  }

  function stopFireworks() {
    if(fwLoop) cancelAnimationFrame(fwLoop);
    fwCtx.clearRect(0, 0, fwCanvas.width, fwCanvas.height);
  }

  function speak(text) {
    if ('speechSynthesis' in window) {
      window.speechSynthesis.cancel();
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      utterance.rate = 0.9;
      window.speechSynthesis.speak(utterance);
    }
  }

  // ===== Skills =====
  const SKILLS = [
    { key:"count",  name:"Counting to 20" },
    { key:"ord",    name:"Ordinal Numbers" },
    { key:"pat",    name:"Patterns" },
    { key:"ten",    name:"Tens & Ones" },
    { key:"numPat", name:"Number Patterns" },
    { key:"add",    name:"Addition" },
    { key:"graph",  name:"Picture Graph" },
    { key:"sub",    name:"Subtraction" },
    { key:"time",   name:"Time" },
  ];

  const rand = (a,b)=> Math.floor(Math.random()*(b-a+1))+a;
  const shuffle = (arr)=> arr.map(v=>({v, r:Math.random()})).sort((a,b)=>a.r-b.r).map(x=>x.v);

  // ===== Question Builders (12 questions) =====

  // 1. Counting: Show items to count (10-20)
  function qCounting(){
    const n = rand(10, 20); 
    const item = ["üçé","‚≠ê","üéà","üçÑ","üç™"][rand(0,4)];
    
    let itemsHtml = "";
    for(let i=0; i<n; i++) itemsHtml += `<div class="count-item">${item}</div>`;

    const wrongs = shuffle([n+1, n-1, n+2].filter(x=>x>0)).slice(0,2);
    
    const text = `How many ${item} are there?`;
    return {
      skill:"count", tag:"üî¢ Counting",
      prompt: text,
      html:`<div class="prompt">${text}<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
            <div class="count-grid">${itemsHtml}</div>
            <div class="hint">Count one by one.</div>`,
      choices: shuffle([String(n), ...wrongs.map(String)]),
      answer: String(n)
    };
  }

  // 2. Counting: Compare (10-20)
  function qCounting2(){
    const a = rand(12,20);
    const b = a - rand(1,5);
    const ask = `Which number is bigger?`;
    const right = a;
    const wrong = b;
    return {
      skill:"count", tag:"üî¢ Counting",
      prompt:ask,
      html:`<div class="prompt">${ask}<span class="speak-btn" onclick="speak('${ask}')">üîä</span></div>
            <div style="display:flex;gap:12px;justify-content:center;margin-top:10px">
              <div style="font-size:44px;font-weight:950;border:3px solid #cbd5e1;background:#fff;padding:10px 16px;border-radius:18px; color:#475569">${a}</div>
              <div style="font-size:44px;font-weight:950;border:3px solid #cbd5e1;background:#fff;padding:10px 16px;border-radius:18px; color:#475569">${b}</div>
            </div>
            <div class="hint">Choose the bigger number.</div>`,
      choices: shuffle([String(right), String(wrong), String(right+1)]),
      answer: String(right)
    };
  }

  // 3. Ordinal: 10 different animals (Fixed: Single Line)
  function qOrdinal(){
    const pool = ["üê∂","üê±","üê∞","ü¶ä","üêº","üêØ","üê∏","ü¶Å","üêÆ","üê®"];
    const rowAnimals = shuffle(pool).slice(0,10);
    const pos = rand(1,10); 
    const ordMap = {1:"1st",2:"2nd",3:"3rd",4:"4th",5:"5th", 6:"6th",7:"7th",8:"8th",9:"9th",10:"10th"};
    const ordStr = ordMap[pos];
    const targetAnimal = rowAnimals[pos-1];

    // Reduced font-size slightly to 28px to fit easier without scrolling if possible, but scroll remains
    const rowHtml = rowAnimals.map(a => `<span style="font-size:28px;margin:0 4px">${a}</span>`).join("");
    
    const wrongs = shuffle(rowAnimals.filter(x=>x!==targetAnimal)).slice(0,2);
    const text = `Which animal is ${ordStr}?`;

    return {
      skill:"ord", tag:"ü•á Ordinal",
      prompt: text,
      html:`<div class="prompt">Which animal is <span style="color:var(--c-pink);margin:0 6px">${ordStr}</span>?<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
            <div style="display:flex; justify-content:center; gap:5px; flex-wrap:nowrap; overflow-x:auto; padding:15px 0; background:#f0f9ff; border-radius:12px;">${rowHtml}</div>
            <div class="hint">Count from left to right ‚Üí</div>`,
      choices: shuffle([targetAnimal, ...wrongs]),
      answer: targetAnimal
    };
  }

  // 4. Patterns: Shapes (Fixed: Single Line)
  function qPatterns(){
    const type = rand(0,2);
    const circle = `<svg width="40" height="40" viewBox="0 0 40 40" style="vertical-align:middle"><circle cx="20" cy="20" r="16" fill="#ef4444" /></svg>`;
    const square = `<svg width="40" height="40" viewBox="0 0 40 40" style="vertical-align:middle"><rect x="6" y="6" width="28" height="28" fill="#3b82f6" rx="4" /></svg>`;
    const triangle = `<svg width="40" height="40" viewBox="0 0 40 40" style="vertical-align:middle"><polygon points="20,6 34,34 6,34" fill="#f59e0b" stroke-linejoin="round" stroke-width="4" stroke="#f59e0b"/></svg>`;
    const rect = `<svg width="40" height="40" viewBox="0 0 40 40" style="vertical-align:middle"><rect x="4" y="10" width="32" height="20" fill="#10b981" rx="4" /></svg>`;
    
    const shapes = [circle, square, triangle, rect];
    
    let A = shapes[rand(0,3)];
    let B = shapes[rand(0,3)];
    while(B===A) B = shapes[rand(0,3)];
    let C = shapes[rand(0,3)];
    while(C===A || C===B) C = shapes[rand(0,3)];

    let seq = [];
    let ans = "";
    
    if(type===0) { seq = [A,B,A,B,A]; ans = B; }
    else if(type===1) { seq = [A,B,C,A,B]; ans = C; }
    else { seq = [A,A,B,A,A]; ans = B; }

    const wrongs = shapes.filter(x=>x!==ans).slice(0,2);
    const text = "What comes next?";

    return {
      skill:"pat", tag:"üß© Pattern",
      prompt: text,
      html:`<div class="prompt">${text}<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
            <div style="text-align:center;padding:20px 0; display:flex; justify-content:center; gap:8px; align-items:center; white-space:nowrap; overflow-x:auto;">
              ${seq.join("")}
            </div>
            <div class="hint">Look at the repeating pattern.</div>`,
      choices: shuffle([ans, ...wrongs]),
      answer: ans
    };
  }

  // FIXED: Renamed inner classes to avoid conflicts
  function qTensOnes(){
    const n = rand(11,19);
    const ones = n - 10;
    const cells = [];
    // Using t-dot instead of dot to avoid conflict with gridNav if any
    for(let i=0;i<10;i++) cells.push(`<div class="cell"><div class="t-dot"></div></div>`);
    for(let i=0;i<ones;i++) cells.push(`<div class="cell"><div class="t-dot blue"></div></div>`);
    while(cells.length < 20) cells.push(`<div class="cell"></div>`);

    const wrongs = shuffle([n+1, n-1, n+2].filter(x=>x>=10 && x<=20)).slice(0,2);
    const text = "How many dots?";
    return {
      skill:"ten", tag:"üßÆ Tens & Ones",
      prompt: text,
      html:`<div class="two-cols">
              <div>
                <div class="prompt">How many?<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
                <div class="hint">Green = 10, Blue = Ones.</div>
              </div>
              <div class="tenframe" style="max-width:300px;">
                ${cells.join("")}
              </div>
            </div>`,
      choices: shuffle([String(n), ...wrongs.map(String)]),
      answer: String(n)
    };
  }

  function qNumberPattern(){
    const type = rand(0, 2);
    const A = rand(1, 9);
    let B = rand(1, 9); while(B===A) B = rand(1,9);
    let C = rand(1, 9); while(C===A || C===B) C = rand(1,9);
    
    let seq = [];
    let ans = 0;
    
    if(type === 0) { seq = [A, B, A, B, A]; ans = B; }
    else if (type === 1) { seq = [A, B, C, A, B, C, A]; ans = B; }
    else { seq = [A, A, B, A, A, B, A]; ans = A; }

    const wrongs = shuffle([ans+1, ans-1, ans+2].filter(x=>x>0)).slice(0,2);
    const text = "What number comes next?";
    
    return {
      skill:"numPat", tag:"üìà Number pattern",
      prompt: text,
      html:`<div class="prompt">${text}<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
            <div style="text-align:center;font-size:40px;font-weight:950;padding:10px 0; color:#334155">
              ${seq.join(" , ")} , <span style="color:var(--c-pink)">?</span>
            </div>
            <div class="hint">Look for the repeating pattern.</div>`,
      choices: shuffle([String(ans), ...wrongs.map(String)]),
      answer: String(ans)
    };
  }

  function qAddition(){
    const a = rand(6,10), b = rand(6,10);
    const ans = a + b; 
    const wrongs = shuffle([ans+1, ans-1, ans+2].filter(x=>x!==ans)).slice(0,2);
    const text = `There are ${a} apples and ${b} more apples. How many in total?`;
    return {
      skill:"add", tag:"‚ûï Addition",
      prompt:`Story addition`,
      html:`<div class="prompt">Story time!<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
            <div style="font-size:20px;font-weight:900;line-height:1.4; color:#334155">
              There are <span style="color:var(--c-pink)">${a}</span> apples üçé and <span style="color:var(--c-blue)">${b}</span> more apples üçé.<br>
              How many apples in total?
            </div>
            <div class="hint">${a} + ${b} = ?</div>`,
      choices: shuffle([String(ans), ...wrongs.map(String)]),
      answer: String(ans)
    };
  }

  function qAddition2(){
    const a = rand(10,15), b = rand(1,5);
    const ans = a + b;
    const wrongs = shuffle([ans+1, ans-1, ans+2].filter(x=>x!==ans)).slice(0,2);
    const text = `${a} plus ${b} equals what?`;
    return {
      skill:"add", tag:"‚ûï Addition",
      prompt:`Addition`,
      html:`<div class="prompt">Add<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
            <div style="text-align:center;font-size:52px;font-weight:950;margin:8px 0; color:var(--c-blue)">${a} + ${b} = ?</div>`,
      choices: shuffle([String(ans), ...wrongs.map(String)]),
      answer: String(ans)
    };
  }

  // 7. Graph (Fixed: Single Line Rows)
  function qGraph(){
    const items = [
      {name:"Cats", icon:"üê±"},
      {name:"Dogs", icon:"üê∂"},
      {name:"Fish", icon:"üê†"},
    ];
    let counts = shuffle([2,3,4,5]).slice(0,3);
    const data = items.map((it,i)=>({ ...it, n: counts[i] }));
    const maxItem = data.reduce((m,x)=> x.n>m.n?x:m, data[0]);

    const graphHtml = data.map(d=>{
      const icons = Array.from({length:d.n}, ()=>`<span class="miniIcon">${d.icon}</span>`).join("");
      return `
        <div class="gline">
          <div class="gleft" style="font-size:18px;">${d.icon} ${d.name}</div>
          <div class="icons">${icons}</div>
        </div>
      `;
    }).join("");

    const wrongs = shuffle(data.filter(d=>d.name!==maxItem.name)).slice(0,2).map(d=>d.name);
    const text = "Which group has the most?";

    return {
      skill:"graph", tag:"üìä Picture graph",
      prompt: text,
      html:`<div class="two-cols">
              <div>
                <div class="prompt">Which has the most?<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
                <div class="hint">Count the icons.</div>
              </div>
              <div class="graph">
                ${graphHtml}
              </div>
            </div>`,
      choices: shuffle([maxItem.name, ...wrongs]),
      answer: maxItem.name
    };
  }

  function qSub(){
    const total = rand(12,20);
    const take = rand(2, 5);
    const ans = total - take;
    const wrongs = shuffle([ans+1, ans-1, ans+2].filter(x=>x>=0 && x!==ans)).slice(0,2);
    const text = `You have ${total} balloons. ${take} fly away. How many left?`;
    return {
      skill:"sub", tag:"‚ûñ Subtraction",
      prompt:`Story subtraction`,
      html:`<div class="prompt">How many left?<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
            <div style="font-size:20px;font-weight:900;line-height:1.4; color:#334155">
              You have <span style="color:var(--c-pink)">${total}</span> balloons üéà.<br>
              <span style="color:var(--c-blue)">${take}</span> balloons fly away üí®.<br>
              How many balloons left?
            </div>
            <div class="hint">${total} ‚àí ${take} = ?</div>`,
      choices: shuffle([String(ans), ...wrongs.map(String)]),
      answer: String(ans)
    };
  }

  function qSub2(){
    const a = rand(15,20);
    const b = rand(1,9);
    const ans = a - b;
    const wrongs = shuffle([ans+1, ans-1, ans+2].filter(x=>x>=0 && x!==ans)).slice(0,2);
    const text = `${a} minus ${b} equals what?`;
    return {
      skill:"sub", tag:"‚ûñ Subtraction",
      prompt:`Subtract`,
      html:`<div class="prompt">Subtract<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
            <div style="text-align:center;font-size:52px;font-weight:950;margin:8px 0; color:var(--c-pink)">${a} ‚àí ${b} = ?</div>`,
      choices: shuffle([String(ans), ...wrongs.map(String)]),
      answer: String(ans)
    };
  }

  // 9. Time (Fixed: Minute hand locked to 12)
  function qTime(){
    const hour = rand(1,12);
    const answer = `${hour}:00`;
    const wrongs = shuffle([((hour%12)+1), (hour===1?12:hour-1), (hour+2>12?hour-10:hour+2)])
      .slice(0,2).map(h=>`${h}:00`);

    const hourDeg = hour * 30;

    const ticks = Array.from({length:12}, (_,i)=>{
      const deg = (i*30);
      return `<div class="tick" style="transform: translate(-50%,-50%) rotate(${deg}deg) translate(0,-95px);"></div>`;
    }).join("");
    
    const nums = Array.from({length:12}, (_,i)=>{
      const n = i+1;
      const deg = n*30;
      const r = 75;
      const x = Math.sin((deg*Math.PI)/180)*r;
      const y = -Math.cos((deg*Math.PI)/180)*r;
      return `<div class="num" style="transform: translate(${x}px, ${y}px) translate(-50%,-50%);">${n}</div>`;
    }).join("");

    const text = "What time is it?";
    return {
      skill:"time", tag:"üïí Time (o‚Äôclock)",
      prompt: text,
      html:`<div class="two-cols">
              <div>
                <div class="prompt">What time is it?<span class="speak-btn" onclick="speak('${text}')">üîä</span></div>
                <div class="hint">Minute hand is on 12.</div>
              </div>
              <div class="clock">
                ${ticks}
                ${nums}
                <div class="hand hour" style="transform: translateX(-50%) translateY(-100%) rotate(${hourDeg}deg);"></div>
                <div class="hand minute" style="transform: translateX(-50%) translateY(-100%) rotate(0deg);"></div>
                <div class="center"></div>
              </div>
            </div>`,
      choices: shuffle([answer, ...wrongs]),
      answer
    };
  }

  // Build 12 questions (balanced)
  function buildQuestions(){
    const qs = [
      qCounting(), qCounting2(),
      qOrdinal(),
      qPatterns(),
      qTensOnes(),
      qNumberPattern(),
      qAddition(), qAddition2(),
      qGraph(),
      qSub(), qSub2(),
      qTime(),
    ];
    return qs;
  }

  // ===== State =====
  let QUESTIONS = [];
  let current = 0;
  let answers = []; 
  let flagged = new Set();
  let started = false;
  let submitted = false;

  const TOTAL_SECONDS = 8 * 60; // 08:00
  let leftSec = TOTAL_SECONDS;
  let timerId = null;

  // ===== DOM =====
  const startBtn = document.getElementById("startBtn");
  const resetBtn = document.getElementById("resetBtn");
  const welcome = document.getElementById("welcome");
  const quiz = document.getElementById("quiz");
  const finish = document.getElementById("finish");

  const qTitle = document.getElementById("qTitle");
  const qTag = document.getElementById("qTag");
  const qBox = document.getElementById("qBox");
  const choicesEl = document.getElementById("choices");

  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");
  const flagBtn = document.getElementById("flagBtn");
  const submitBtn = document.getElementById("submitBtn");

  const gridNav = document.getElementById("gridNav");

  const chipTimer = document.getElementById("chipTimer");
  const chipStatus = document.getElementById("chipStatus");
  const chipScore = document.getElementById("chipScore");
  const chipLevel = document.getElementById("chipLevel");

  const mini = document.getElementById("mini");
  const bar = document.getElementById("bar");

  const skillBox = document.getElementById("skillBox");
  const breakHint = document.getElementById("breakHint");

  const finalTitle = document.getElementById("finalTitle");
  const finalText = document.getElementById("finalText");
  const reviewBtn = document.getElementById("reviewBtn");
  const newBtn = document.getElementById("newBtn");
  const reviewBox = document.getElementById("reviewBox");

  function fmtTime(s){
    const m = String(Math.floor(s/60)).padStart(2,"0");
    const sec = String(s%60).padStart(2,"0");
    return `${m}:${sec}`;
  }

  function setBar(pct){ bar.style.width = `${pct}%`; }

  function setStatus(){
    const done = answers.filter(x=>x && x.choice!=null).length;
    chipStatus.textContent = `üß© ${done} / ${QUESTIONS.length}`;
    const pct = Math.round((done/QUESTIONS.length)*100);
    setBar(pct);
    mini.textContent = started ? `In Progress... (${done}/${QUESTIONS.length})` : "Not started";
  }

  function renderGrid(){
    gridNav.innerHTML = "";
    for(let i=0;i<QUESTIONS.length;i++){
      const b = document.createElement("button");
      b.className = "nav-item";
      if(i===current) b.classList.add("cur");
      if(answers[i] && answers[i].choice!=null) b.classList.add("answered");
      if(flagged.has(i)) b.classList.add("flag");
      b.textContent = i+1;
      b.onclick = ()=> { 
        if(!submitted){ 
          sfxNav();
          current=i; renderQuestion(); 
        } 
      };
      gridNav.appendChild(b);
    }
  }

  function renderQuestion(){
    const q = QUESTIONS[current];
    qTitle.textContent = `Question ${current+1}`;
    qTag.textContent = q.tag;
    qBox.innerHTML = q.html;

    choicesEl.innerHTML = "";
    q.choices.forEach(c=>{
      const btn = document.createElement("button");
      btn.className = "choice";
      btn.type = "button";
      btn.innerHTML = c;

      if(submitted){
        btn.disabled = true;
        if(c === q.answer) btn.classList.add("correct");
        const a = answers[current];
        if(a && a.choice === c && c !== q.answer) btn.classList.add("wrong");
      }else{
        const a = answers[current];
        if(a && a.choice === c) btn.classList.add("selected");
        btn.onclick = ()=> {
          sfxSelect();
          selectChoice(c);
        };
      }

      choicesEl.appendChild(btn);
    });

    flagBtn.textContent = flagged.has(current) ? "üö© Unflag" : "üö© Flag";
    renderGrid();
    setStatus();
  }

  function selectChoice(choice){
    const q = QUESTIONS[current];
    answers[current] = {
      choice,
      correct: choice === q.answer,
      skill: q.skill
    };
    renderQuestion();
  }

  function toggleFlag(){
    sfxClick();
    if(flagged.has(current)) flagged.delete(current);
    else flagged.add(current);
    renderQuestion();
  }

  function tick(){
    leftSec -= 1;
    if(leftSec < 0) leftSec = 0;
    chipTimer.textContent = `‚è± ${fmtTime(leftSec)}`;
    if(leftSec === 0){
      submit(true);
    }
  }

  function start(){
    sfxClick();
    QUESTIONS = buildQuestions();
    answers = Array.from({length:QUESTIONS.length}, ()=> ({choice:null, correct:false, skill:null}));
    flagged = new Set();
    current = 0;
    submitted = false;
    started = true;

    leftSec = TOTAL_SECONDS;
    chipTimer.textContent = `‚è± ${fmtTime(leftSec)}`;

    if(timerId) clearInterval(timerId);
    timerId = setInterval(tick, 1000);

    chipScore.textContent = "‚≠ê Score: ‚Äî";
    chipLevel.textContent = "üè∑ Level: ‚Äî";
    breakHint.textContent = "Shown after submission";
    skillBox.innerHTML = "";

    welcome.style.display = "none";
    finish.style.display = "none";
    quiz.style.display = "block";
    reviewBox.style.display = "none";

    setBar(0);
    mini.textContent = "In Progress...";
    renderQuestion();
  }

  function reset(){
    sfxClick();
    if(timerId) clearInterval(timerId);
    timerId = null;
    stopFireworks();

    started = false;
    submitted = false;
    QUESTIONS = [];
    answers = [];
    flagged = new Set();
    current = 0;
    leftSec = TOTAL_SECONDS;

    chipTimer.textContent = `‚è± ${fmtTime(leftSec)}`;
    chipStatus.textContent = "üß© 0/12";
    chipScore.textContent = "‚≠ê ‚Äî";
    chipLevel.textContent = "üè∑ ‚Äî";
    mini.textContent = "Not started";
    setBar(0);

    breakHint.textContent = "Shown after submission";
    skillBox.innerHTML = "";

    quiz.style.display = "none";
    finish.style.display = "none";
    welcome.style.display = "grid";
    reviewBox.style.display = "none";
  }

  function classify(pct){
    if(pct >= 85) return {level:"Excellent", pill:"ok"};
    if(pct >= 70) return {level:"Good", pill:"mid"};
    if(pct >= 50) return {level:"Developing", pill:"mid"};
    return {level:"Needs Practice", pill:"bad"};
  }

  function renderSkillBreakdown(){
    const map = new Map(SKILLS.map(s=>[s.key,{name:s.name, correct:0, total:0}]));
    answers.forEach((a,i)=>{
      const sk = QUESTIONS[i].skill;
      const obj = map.get(sk);
      if(obj){
        obj.total += 1;
        if(a && a.correct) obj.correct += 1;
      }
    });

    skillBox.innerHTML = "";
    for(const s of SKILLS){
      const o = map.get(s.key);
      if(!o || o.total===0) continue;
      const pct = Math.round((o.correct/o.total)*100);
      let pillClass = "bad";
      if(pct === 100) pillClass = "ok";
      else if(pct >= 50) pillClass = "mid";

      const div = document.createElement("div");
      div.className = "skill";
      div.innerHTML = `
        <div>
          <b>${o.name}</b>
          <span>${o.correct}/${o.total} correct</span>
        </div>
        <div class="pill ${pillClass}">${pct}%</div>
      `;
      skillBox.appendChild(div);
    }
    breakHint.textContent = "Results by Skill";
  }

  function submit(fromTimer=false){
    if(submitted || !started) return;
    sfxSubmit();
    
    submitted = true;

    if(timerId) clearInterval(timerId);
    timerId = null;

    const correct = answers.filter(a=>a && a.correct).length;
    const total = QUESTIONS.length;
    const pct = Math.round((correct/total)*100);
    const cls = classify(pct);

    chipScore.textContent = `‚≠ê Score: ${correct}/${total}`;
    chipLevel.textContent = `üè∑ Level: ${cls.level}`;

    renderSkillBreakdown();

    quiz.style.display = "none";
    finish.style.display = "grid"; 

    startFireworks();

    finalTitle.textContent = fromTimer ? "Time's up!" : "Test Submitted!";
    finalText.innerHTML = `
      Score: <b>${correct}/${total}</b> (${pct}%)<br>
      Level: <b>${cls.level}</b><br>
      ${fromTimer ? "<span style='color:var(--c-orange)'>‚è± Auto-submitted (Time's up)</span>" : "<span style='color:var(--c-green)'>‚úÖ Completed</span>"}
    `;

    reviewBtn.disabled = false;
  }

  function buildReview(){
    sfxClick();
    reviewBox.innerHTML = "";
    QUESTIONS.forEach((q,i)=>{
      const a = answers[i];
      const ok = a && a.correct;
      const div = document.createElement("div");
      div.className = "reviewItem";
      div.innerHTML = `
        <b>Q${i+1} ‚Ä¢ ${q.tag}</b>
        <div class="m">${q.prompt}</div>
        <div class="a">
          Your answer: <span class="${ok ? "okTxt":"badTxt"}">${a.choice ?? "‚Äî"}</span><br>
          Correct answer: <span class="okTxt">${q.answer}</span>
        </div>
      `;
      reviewBox.appendChild(div);
    });
  }

  // ===== Events =====
  startBtn.onclick = start;
  resetBtn.onclick = reset;

  prevBtn.onclick = ()=> { if(!submitted){ sfxNav(); current = Math.max(0, current-1); renderQuestion(); } };
  nextBtn.onclick = ()=> { if(!submitted){ sfxNav(); current = Math.min(QUESTIONS.length-1, current+1); renderQuestion(); } };
  flagBtn.onclick = ()=> { if(!submitted) toggleFlag(); };

  submitBtn.onclick = ()=> { sfxClick(); submit(false); };

  reviewBtn.onclick = ()=>{
    if(reviewBox.style.display === "none"){
      buildReview();
      reviewBox.style.display = "block";
      reviewBtn.textContent = "üôà Hide Review";
    }else{
      reviewBox.style.display = "none";
      reviewBtn.textContent = "üëÄ Review Answers";
    }
  };

  newBtn.onclick = start;

  reset();
</script>
</body>
</html>
